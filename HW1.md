Homework \#1
================
David Nemirovsky
2/14/21

In this exercise, we will predict solubility of compounds using their
chemical structures. The training data are in the file
“solubility\_train.csv” and the test data are in
“solubility\_test.csv”. Among the 228 predictors, 208 are binary
variables that indicate the presence or absence of a particular chemical
substructure, 16 are count features, such as the number of bonds or the
number of bromine atoms, and 4 are continuous features, such as
molecular weight or surface area. The response is in the column
“Solubility” (the last column).

1)  Fit a linear model using least squares on the training data and
    calculate the mean squared error using the test data.

<!-- end list -->

  - First, let’s read in the data:

<!-- end list -->

``` r
train_df = read_csv("solubility_train.csv")
test_df = read_csv("solubility_test.csv")
```

  - Next, let’s create a linear model with 10-fold CV:

<!-- end list -->

``` r
set.seed(37564)
ctrl = trainControl(method = "cv", number = 10)
model_lm = train(Solubility~., 
               data = train_df, 
               method = "lm", 
               trControl = ctrl)

model_lm$finalModel$coefficients %>% 
  broom::tidy() %>% 
  knitr::kable(col.names = c("Predictor", "Beta Value"))
```

| Predictor         |   Beta Value |
| :---------------- | -----------: |
| (Intercept)       |    2.4307073 |
| FP001             |    0.3593637 |
| FP002             |    0.1455962 |
| FP003             |  \-0.0396932 |
| FP004             |  \-0.3048941 |
| FP005             |    2.8367245 |
| FP006             |  \-0.0688605 |
| FP007             |    0.0404391 |
| FP008             |    0.1121160 |
| FP009             |  \-0.8242261 |
| FP010             |    0.4193129 |
| FP011             |    0.0515819 |
| FP012             |  \-0.0134551 |
| FP013             |  \-0.4518555 |
| FP014             |    0.3281228 |
| FP015             |  \-0.1839154 |
| FP016             |  \-0.1367002 |
| FP017             |  \-0.1704358 |
| FP018             |  \-0.3824335 |
| FP019             |  \-0.3131000 |
| FP020             |    0.2071759 |
| FP021             |  \-0.0595630 |
| FP022             |    0.2336336 |
| FP023             |  \-0.3193254 |
| FP024             |  \-0.4272191 |
| FP025             |    0.4376374 |
| FP026             |    0.2067680 |
| FP027             |    0.2423901 |
| FP028             |    0.1070430 |
| FP029             |  \-0.0985727 |
| FP030             |  \-0.2361162 |
| FP031             |    0.0869040 |
| FP032             |  \-1.2044863 |
| FP033             |    0.5766339 |
| FP034             |  \-0.1793970 |
| FP035             |  \-0.2139666 |
| FP036             |    0.0770144 |
| FP037             |    0.1097876 |
| FP038             |    0.2721086 |
| FP039             |    0.0201134 |
| FP040             |    0.5477244 |
| FP041             |  \-0.4265237 |
| FP042             |  \-0.9900896 |
| FP043             |  \-0.0372482 |
| FP044             |  \-0.3859623 |
| FP045             |    0.2119504 |
| FP046             |  \-0.0350450 |
| FP047             |  \-0.0167462 |
| FP048             |    0.2610329 |
| FP049             |    0.1241333 |
| FP050             |    0.0090865 |
| FP051             |    0.1050135 |
| FP052             |  \-0.4569080 |
| FP053             |    0.2994138 |
| FP054             |    0.0273424 |
| FP055             |  \-0.3661526 |
| FP056             |  \-0.2961311 |
| FP057             |  \-0.1002038 |
| FP058             |    0.3100159 |
| FP059             |  \-0.1614836 |
| FP060             |    0.2350486 |
| FP061             |  \-0.6365304 |
| FP062             |  \-0.5224157 |
| FP063             |  \-2.0009445 |
| FP064             |    0.2549351 |
| FP065             |  \-0.2844497 |
| FP066             |    0.2092773 |
| FP067             |  \-0.1406065 |
| FP068             |    0.4964047 |
| FP069             |    0.1324178 |
| FP070             |    0.0034526 |
| FP071             |    0.1473905 |
| FP072             |  \-0.9773384 |
| FP073             |  \-0.4671401 |
| FP074             |    0.1792652 |
| FP075             |    0.1230577 |
| FP076             |    0.5165583 |
| FP077             |    0.1643990 |
| FP078             |  \-0.3714665 |
| FP079             |    0.4254428 |
| FP080             |    0.3100544 |
| FP081             |  \-0.3207553 |
| FP082             |    0.1242727 |
| FP083             |  \-0.6916390 |
| FP084             |    0.3626367 |
| FP085             |  \-0.3309658 |
| FP086             |    0.0116900 |
| FP087             |    0.0455920 |
| FP088             |    0.2415558 |
| FP089             |    0.5999370 |
| FP090             |  \-0.0245036 |
| FP091             |  \-0.2857602 |
| FP092             |    0.2665497 |
| FP093             |    0.1974210 |
| FP094             |  \-0.1990652 |
| FP095             |  \-0.1402989 |
| FP096             |  \-0.5024174 |
| FP097             |  \-0.2635359 |
| FP098             |  \-0.2864536 |
| FP099             |    0.2591782 |
| FP100             |  \-0.4007991 |
| FP101             |  \-0.1759932 |
| FP102             |    0.2445464 |
| FP103             |  \-0.1492643 |
| FP104             |  \-0.1427685 |
| FP105             |  \-0.0691176 |
| FP106             |    0.1127634 |
| FP107             |    2.7779666 |
| FP108             |    0.0088356 |
| FP109             |    0.8199741 |
| FP110             |    0.3679643 |
| FP111             |  \-0.5564779 |
| FP112             |  \-0.1078868 |
| FP113             |    0.1510756 |
| FP114             |  \-0.1200949 |
| FP115             |  \-0.1895825 |
| FP116             |    0.0077783 |
| FP117             |    0.2582847 |
| FP118             |  \-0.1963735 |
| FP119             |    0.7514679 |
| FP120             |  \-0.1813515 |
| FP121             |  \-0.0473144 |
| FP122             |    0.1047909 |
| FP123             |    0.0392621 |
| FP124             |    0.1234651 |
| FP125             |  \-0.0002633 |
| FP126             |  \-0.2781620 |
| FP127             |  \-0.6122520 |
| FP128             |  \-0.5424304 |
| FP129             |  \-0.0673123 |
| FP130             |  \-1.0339635 |
| FP131             |    0.2158071 |
| FP132             |  \-0.1976246 |
| FP133             |  \-0.1573500 |
| FP134             |    2.4960171 |
| FP135             |    0.1817864 |
| FP136             |  \-0.0776324 |
| FP137             |  \-0.0461261 |
| FP138             |  \-0.0939216 |
| FP139             |    0.0765908 |
| FP140             |    0.3145386 |
| FP141             |    0.2219191 |
| FP142             |    0.6271871 |
| FP143             |    0.9981011 |
| FP144             |    0.2206593 |
| FP145             |  \-0.1145723 |
| FP146             |  \-0.2323552 |
| FP147             |    0.1501710 |
| FP148             |  \-0.1600227 |
| FP149             |    0.1172060 |
| FP150             |    0.0904610 |
| FP151             |    0.2898761 |
| FP152             |  \-0.2543950 |
| FP153             |  \-0.3764599 |
| FP154             |  \-1.0271716 |
| FP155             |    0.4887988 |
| FP156             |  \-0.0360217 |
| FP157             |  \-0.4714552 |
| FP158             |    0.0166913 |
| FP159             |    0.1800243 |
| FP160             |    0.0152547 |
| FP161             |  \-0.2439620 |
| FP162             |    0.0491043 |
| FP163             |    0.4785031 |
| FP164             |    0.5096481 |
| FP165             |    0.5793388 |
| FP166             |  \-0.0658208 |
| FP167             |  \-0.6043747 |
| FP168             |  \-0.1187060 |
| FP169             |  \-0.1704501 |
| FP170             |  \-0.0790151 |
| FP171             |    0.4651390 |
| FP172             |  \-0.4425755 |
| FP173             |    0.4243419 |
| FP174             |  \-0.1010089 |
| FP175             |  \-0.0465741 |
| FP176             |    0.9736304 |
| FP177             |    0.1386190 |
| FP178             |    0.0649749 |
| FP179             |  \-0.0341457 |
| FP180             |  \-0.7904560 |
| FP181             |    0.4925405 |
| FP182             |  \-0.1123825 |
| FP183             |    0.2997852 |
| FP184             |    0.4875761 |
| FP185             |  \-0.3777906 |
| FP186             |  \-0.3654254 |
| FP187             |    0.4457250 |
| FP188             |    0.1475076 |
| FP189             |  \-0.0198448 |
| FP190             |    0.2628656 |
| FP191             |    0.2799151 |
| FP192             |  \-0.2404048 |
| FP193             |    0.1501758 |
| FP194             |    0.8028828 |
| FP195             |    0.0596677 |
| FP196             |    0.0109090 |
| FP197             |  \-0.0373622 |
| FP198             |    0.1896334 |
| FP199             |  \-0.0993207 |
| FP200             |  \-0.0642051 |
| FP201             |  \-0.4838360 |
| FP202             |    0.5663846 |
| FP203             |    0.2585935 |
| FP204             |  \-0.1370842 |
| FP205             |    0.0717654 |
| FP206             |  \-0.0676861 |
| FP207             |  \-0.0055380 |
| FP208             |  \-0.5338134 |
| MolWeight         |  \-1.2317813 |
| NumAtoms          | \-14.7846976 |
| NumNonHAtoms      |   17.9487803 |
| NumBonds          |    9.8433928 |
| NumNonHBonds      | \-10.3007205 |
| NumMultBonds      |    0.2106860 |
| NumRotBonds       |  \-0.5213104 |
| NumDblBonds       |  \-0.7491550 |
| NumAromaticBonds  |  \-2.3643802 |
| NumHydrogen       |    0.8347470 |
| NumCarbon         |    0.0173046 |
| NumNitrogen       |    6.1253610 |
| NumOxygen         |    2.3893796 |
| NumSulfer         |  \-8.5083740 |
| NumChlorine       |  \-7.4487456 |
| NumHalogen        |    1.4081170 |
| NumRings          |    1.2764938 |
| HydrophilicFactor |    0.0109892 |
| SurfaceArea1      |    0.0882479 |
| SurfaceArea2      |    0.0955526 |

  - Now, let’s calculate the MSE using the test data:

<!-- end list -->

``` r
lm_pred = predict(model_lm, newdata = test_df)
mse_lm = mean((lm_pred - test_df$Solubility)^2)
```

  - Therefore, the MSE of this linear model is **0.5559**.
